# Description: Miscellaneous system utilities
# URL:         http://freshmeat.net/projects/util-linux/
# Maintainer:  CRUX System Team, core-ports at crux dot nu
# Depends on:  e2fsprogs, ncurses, zlib

name=util-linux
version=2.13-pre7
release=2
source=(http://www.kernel.org/pub/linux/utils/util-linux/testing/$name-$version.tar.gz \
	$name-$version-nls.patch)

build() {
    cd $name-$version
    patch -p1 -i $SRC/$name-$version-nls.patch
    ./configure --prefix=/ \
        --disable-nls \
        --disable-elvtune \
        --enable-write --enable-rdev --enable-raw --enable-kill

    make
    make DESTDIR=$PKG install
    mkdir -p $PKG/etc
    touch $PKG/etc/adjtime

    # --mandir didn't work
    mv $PKG/usr/share/man $PKG/usr

    rm -rf $PKG/usr/{share,man/man6,share/misc/getopt}
    rm $PKG/sbin/{mkfs.bfs,mkfs.minix,fsck.minix}
    rm $PKG/usr/bin/wall
    rm $PKG/usr/man/man1/wall.1
    rm $PKG/usr/man/man8/{fsck.minix,mkfs.bfs,mkfs.minix}.8
}
