# Description: Miscellaneous system utilities
# URL:         http://userweb.kernel.org/~kzak/util-linux-ng/
# Maintainer:  CRUX System Team, core-ports at crux dot nu
# Depends on:  e2fsprogs, ncurses, zlib

name=util-linux-ng
version=2.15-12-g4bf7d60
release=1
source=(http://crux.nu/~jue/files/dist/$name-$version.tar.bz2)

build() {
    cd $name-$version

    ./autogen.sh
    ./configure --prefix=/usr \
                --mandir=/usr/man \
                --with-fsprobe=builtin \
                --disable-{nls,elvtune,wall} \
                --enable-{write,rdev,raw,kill,fsck}
    make
    make DESTDIR=$PKG install

    mv $PKG/lib/libblkid.{a,la} $PKG/usr/lib
    ln -s /lib/libblkid.so $PKG/usr/lib/libblkid.so

    mkdir -p $PKG/etc
    touch $PKG/etc/adjtime

    rm -r $PKG/usr/share
    rm $PKG/sbin/{mkfs.bfs,mkfs.minix,fsck.minix}
    rm $PKG/usr/man/man8/{fsck.minix,mkfs.bfs,mkfs.minix}.8
}
